# 使用教程（智能体项目）

本教程提供从环境准备、安装、配置到运行的完整步骤，并给出常见问题排查。

## 前置准备

- 操作系统：Windows（当前工作环境）。
- Python：建议 `3.10+`。
- 终端：PowerShell 或任何支持的终端。

## 安装依赖

- 在项目根目录执行：

```
pip install -r requirements.txt
```

- 可选：配置 OpenAI 以启用更强的文本生成：
  - 将 `.env.example` 复制为 `.env` 并填写 `OPENAI_API_KEY`。
  - 设置 `LLM_PROVIDER=openai` 与 `LLM_MODEL=gpt-4o-mini`（或你有访问权限的型号）。

## 环境配置（`.env` 说明）

- `LLM_PROVIDER`：`openai` 或留空（留空时使用回退生成）。
- `LLM_MODEL`：模型名（例如 `gpt-4o-mini`）。
- `OPENAI_API_KEY`：OpenAI API Key。
- `SEARCH_MAX_RESULTS`：搜索最大结果数（默认 5）。
- `MEMORY_MAX_MESSAGES`：记忆窗口上限（默认 20）。
- `MEMORY_FILE`：记忆文件路径（默认 `storage/memory.json`）。
- `LOG_LEVEL`：日志级别（默认 `INFO`）。

## 运行智能体

- 命令行方式：

```
python scripts/run.py --task "帮我搜索今天的科技热点并计算 12*7" --max_steps 3
```

- 输出包含两部分：
  - 工具日志：展示搜索与计算步骤的执行情况。
  - 最终答案：结合工具结果与 LLM 生成的回应。

## 常见问题

- 报错 `ModuleNotFoundError`：确认在项目根目录运行且依赖已安装。
- OpenAI 未配置：脚本仍可运行，但生成质量为回退模式；建议配置 API Key。
- 记忆文件读写失败：检查 `MEMORY_FILE` 路径存在与文件权限；默认路径在 `storage/` 下。

## 进阶使用

- 修改工具触发条件：在 `app/agent/agent.py` 的 `_should_search` 与 `_extract_math` 中调整逻辑。
- 扩展工具：在 `app/tools/` 下新增模块，并在 `Agent.run` 中加入调用流程。
- 集成更多 LLM：扩展 `app/services/llm.py`，增加不同提供商的初始化与调用方式。

---

如需进一步提升，请添加单元测试与更严格的参数校验，并根据你的业务场景完善规划与执行策略。